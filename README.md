# Домашнее задание к занятию «Уязвимости и атаки на информационные системы» Косарев Д.О.

## Задание 1: Анализ уязвимостей Metasploitable

### Какие сетевые службы разрешены?
После установки виртуальной машины Metasploitable было проведено её сканирование с помощью `nmap -sV <IP-адрес>`. В результате обнаружены следующие основные сетевые службы:
*   **21/tcp** - vsftpd 2.3.4 (FTP-сервер)
*   **22/tcp** - OpenSSH 4.7p1 (SSH)
*   **23/tcp** - Linux telnetd (Telnet)
*   **25/tcp** - Postfix smtpd (SMTP)
*   **80/tcp** - Apache httpd 2.2.8 (HTTP-сервер)
*   **139/tcp, 445/tcp** - Samba smbd (NetBIOS/SMB)
*   **512/tcp** - netkit-rsh rexecd (rexec)
*   **513/tcp** - login (rlogin)
*   **514/tcp** - Netkit rshd (rsh)
*   **1099/tcp** - GNU Classpath grmiregistry (Java RMI)
*   **3306/tcp** - MySQL 5.0.51a
*   **5432/tcp** - PostgreSQL DB
*   **8009/tcp** - Apache Jserv (AJP13)
*   **8180/tcp** - Apache Tomcat/Coyote JSP engine

### Какие уязвимости обнаружены?
На основе найденных версий служб на сайте exploit-db.com были определены следующие критические уязвимости (три примера):

1.  **vsftpd 2.3.4 - Backdoor Command Execution**
    *   **Описание:** В FTP-сервере присутствует бэкдор. Отправка в имени пользователя символов `:) ` открывает командную оболочку на порту 6200, позволяя получить полный контроль над системой.
    *   **Ссылка:** [https://www.exploit-db.com/exploits/17491](https://www.exploit-db.com/exploits/17491)

2.  **Samba 3.0.20 - 'chain_reply()' Memory Corruption**
    *   **Описание:** Уязвимость в Samba приводит к повреждению памяти, что позволяет удалённо выполнить произвольный код с правами root через специально сформированный запрос.
    *   **Ссылка:** [https://www.exploit-db.com/exploits/16320](https://www.exploit-db.com/exploits/16320)

3.  **UnrealIRCd 3.2.8.1 - Backdoor Command Execution**
    *   **Описание:** В сервере UnrealIRCd обнаружен бэкдор, позволяющий выполнить произвольные системные команды на сервере.
    *   **Ссылка:** [https://www.exploit-db.com/exploits/16922](https://www.exploit-db.com/exploits/16922)

## Задание 2: Типы сканирования Nmap и анализ трафика

В ходе эксперимента были проведены четыре типа сканирования цели с параллельным захватом трафика в Wireshark. Далее описаны их ключевые отличия с точки зрения сетевого трафика и реакции сервера.

*   **SYN-сканирование (`-sS`)**:
    *   **Трафик:** Отправляется TCP-пакет с флагом `SYN`. На открытый порт сервер отвечает `SYN/ACK`, после чего сканер сразу обрывает соединение пакетом `RST`. На закрытый порт приходит ответ `RST`.
    *   **Реакция сервера:** Порт открыт → `SYN/ACK`; порт закрыт → `RST`. Это быстрое и относительно скрытное сканирование.

*   **FIN-сканирование (`-sF`)**:
    *   **Трафик:** Отправляется TCP-пакет только с флагом `FIN`. Если порт закрыт, сервер (следуя RFC) отвечает `RST`. На открытый порт ответа не следует.
    *   **Реакция сервера:** Порт открыт (на *nix) → нет ответа; порт закрыт → `RST`. Метод может не работать на некоторых ОС (например, Windows).

*   **Xmas-сканирование (`-sX`)**:
    *   **Трафик:** Отправляется TCP-пакет с флагами `FIN`, `PSH` и `URG` (одновременно), что выглядит как "рождественская ёлка". Логика ответа аналогична FIN-сканированию.
    *   **Реакция сервера:** Порт открыт (на *nix) → нет ответа; порт закрыт → `RST`. Используется для обхода простых файрволов.

*   **UDP-сканирование (`-sU`)**:
    *   **Трафик:** Отправляются пустые UDP-дейтаграммы на порты. Если порт закрыт, система возвращает ICMP-пакет "порт недоступен" (type 3, code 3). Отсутствие ответа трактуется как "open|filtered".
    *   **Реакция сервера:** Порт открыт → обычно нет ответа; порт закрыт → ICMP "Port Unreachable". Это самый медленный тип сканирования из-за возможных ограничений на отправку ICMP.
